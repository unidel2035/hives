# PAC File Decompiler

Этот набор инструментов предназначен для декомпиляции и анализа PAC (Proxy Auto-Configuration) файлов.

## Файлы

### Python скрипты
- `pac_decompiler.py` - Базовый декомпилятор PAC файла
- `pac_decompiler_advanced.py` - Улучшенный декомпилятор с поддержкой LZP декомпиляции

### Node.js скрипты
- `pac_reader.js` - JavaScript декомпилятор PAC файла

### Утилиты
- `run_decompiler.sh` - Автоматический запуск всех декомпиляторов
- `README.md` - Эта документация

## Использование

### Python декомпиляторы

#### Базовый декомпилятор
```bash
python3 pac_decompiler.py pac.pac
```

#### Улучшенный декомпилятор (рекомендуется)
```bash
python3 pac_decompiler_advanced.py pac.pac
```

### Node.js декомпилятор
```bash
node pac_reader.js pac.pac
```

### Автоматический запуск
```bash
./run_decompiler.sh
```

## Что извлекается

### 1. Правила прокси
- Основные правила маршрутизации трафика
- Список прокси серверов
- Условия для прямого подключения

### 2. Домены
- Список заблокированных доменов по зонам (.com, .ru, .org и т.д.)
- Статистика по зонам
- Сжатые домены в LZP формате (в улучшенной версии)

### 3. IP адреса
- Список заблокированных IP адресов
- Специальные CIDR диапазоны
- Статистика по IP

### 4. LZP компрессия
- Декомпиляция сжатых данных
- Восстановление полного списка доменов
- Анализ паттернов компрессии

## Выходные файлы

### `pac_rules.json`
Основной файл с результатами анализа:
```json
{
  "proxy_rules": "DIRECT",
  "domains": {...},
  "blocked_ips": [...],
  "special_cidrs": [...],
  "statistics": {
    "total_zones": 100,
    "total_domains": 50000,
    "blocked_ip_count": 6292,
    "special_cidr_count": 8
  }
}
```

### `pac_rules_detailed.json` (улучшенная версия)
Детальный анализ с LZP декомпиляцией

## Особенности

### LZP декомпиляция
PAC файл использует LZP (Lempel-Ziv-Prediction) компрессию для уменьшения размера. Улучшенная версия может частично декомпилировать эти данные.

### Статистика
- Количество зон (.com, .ru, .org и т.д.)
- Общее количество доменов
- Количество заблокированных IP
- Топ-10 зон по количеству доменов

### Безопасность
- Не изменяет исходный PAC файл
- Только чтение и анализ
- Безопасное извлечение данных

## Примеры использования

### Анализ большого PAC файла
```bash
# Используем улучшенную версию для лучшего анализа
python3 pac_decompiler_advanced.py large_pac.pac

# Проверяем результаты
cat pac_rules_detailed.json | jq '.statistics'
```

### Быстрая проверка
```bash
# Базовый анализ
python3 pac_decompiler.py pac.pac

# Автоматический запуск всех скриптов
./run_decompiler.sh
```

## Требования

### Python версия
- Python 3.6+
- Стандартные библиотеки (json, re, base64, zlib)

### Node.js версия
- Node.js 12+
- Стандартные модули (fs, path)

## Структура PAC файла

PAC файл обычно содержит:
1. **Domains** - Словарь заблокированных доменов по зонам
2. **d_ipaddr** - Список заблокированных IP адресов
3. **special** - Специальные CIDR диапазоны
4. **domains_lzp** - Сжатые данные доменов
5. **mask_lzp** - Маска для LZP декомпиляции
6. **FindProxyForURL** - Основная функция определения прокси

## Устранение неполадок

### Ошибки загрузки файла
- Проверьте права доступа к файлу
- Убедитесь что файл существует
- Проверьте кодировку файла

### Неполные данные
- Используйте улучшенную версию для LZP декомпиляции
- Проверьте целостность PAC файла
- Некоторые данные могут быть сжаты и требуют дополнительной обработки

### Производительность
- Большие PAC файлы могут обрабатываться медленно
- LZP декомпиляция может занять время
- Используйте базовую версию для быстрого анализа

## Лицензия

Этот инструмент предназначен для образовательных и исследовательских целей.